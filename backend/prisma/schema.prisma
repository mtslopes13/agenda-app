generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        String          @id @default(cuid())
  email     String          @unique
  name      String
  password  String
  createdAt DateTime        @default(now())
  updatedAt DateTime        @updatedAt

  tasks          Task[]
  finances       Finance[]
  appointments   Appointment[]
  calendarEvents CalendarEvent[]

  @@map("users")
}

enum TaskType {
  META
  IMPORTANTE
  AMANHA
}

model Task {
  id          String     @id @default(cuid())
  title       String
  description String?
  completed   Boolean    @default(false)
  dueDate     DateTime
  type        TaskType   @default(IMPORTANTE)
  userId      String
  createdAt   DateTime   @default(now())
  updatedAt   DateTime   @updatedAt
  
  user        User       @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("tasks")
}

model Finance {
  id          String     @id @default(cuid())
  type        FinanceType
  amount      Float
  description String
  category    String
  date        DateTime
  userId      String
  createdAt   DateTime   @default(now())
  
  user        User       @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("finances")
}

enum FinanceType {
  INCOME
  EXPENSE
}

enum EventType {
  HOLIDAY      // feriado (do sistema)
  BIRTHDAY     // anivers√°rio
  PERSONAL     // eventos pessoais
  WORK         // compromissos de trabalho
  OTHER
}

model Holiday {
  id        String   @id @default(cuid())
  date      DateTime
  name      String
  type      String?
  country   String?  @default("BR")
  state     String?
  city      String?
  year      Int

  @@index([year])
  @@map("holidays")
}

model CalendarEvent {
  id           String        @id @default(cuid())
  title        String
  description  String?
  date         DateTime
  allDay       Boolean      @default(true)
  type         EventType    @default(PERSONAL)
  color        String?

  userId       String?
  user         User?        @relation(fields: [userId], references: [id])

  appointments Appointment[]

  @@map("calendar_events")
}

model Appointment {
  id          String        @id @default(cuid())
  title       String
  description String?
  date        DateTime
  startTime   String
  endTime     String
  location    String?
  color       String?

  userId      String
  user        User          @relation(fields: [userId], references: [id], onDelete: Cascade)

  eventId     String?
  event       CalendarEvent? @relation(fields: [eventId], references: [id], onDelete: Cascade)

  @@map("appointments")
}